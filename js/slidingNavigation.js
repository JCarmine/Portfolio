(function(e){function o(t){count=0;r.each(function(){if(e(this).find("a").attr("rel")===t){position=count}count++});return position}function u(){$newpage.load(settings.url,function(){if(_thisSlideCallback!==""){settings.callbacks[_thisSlideCallback]()}i.css("min-height",$newpage.css("height"));$newpage.css("min-height",$newpage.css("height"));_toLoad=false})}function a(e){path=e.path;if(path.charAt(0)==="/"){path=path.substr(1)}if(path.charAt(path.length-1)==="/"){path=path.substr(0,path.length-1)}settings.toLoad=path;if(!s&&settings.toLoad!==""){h()}}function f(t){if(t.data("transition")!=null){if(t.data("transition").slideScroll!=null&&t.data("transition").slideScroll!==""){_thisSlideScroll=t.data("transition").slideScroll}if(t.data("transition").easing!=null&&t.data("transition").easing!==""){_thisSlideEasing=t.data("transition").easing}if(t.data("transition").callback!=null&&t.data("transition").callback!==""){_thisSlideCallback=t.data("transition").callback;_thisSlideCallback=function(){e(this).data("transition").callback}}}settings.toLoad=t.attr("rel");window.location="#/"+settings.toLoad;if(s){h()}}function l(){e("body").append('<a class="next">Next</a>');e("body").append('<a class="prev">Prev</a>');e(".next").css("top",Math.round((t.height()-e(".next").height())/2));e(".prev").css("top",Math.round((t.height()-e(".prev").height())/2));e(".next , .prev").click(function(){f(e(this));return false})}function c(t){var n=e("ul").index(t.parents().eq(1));if(n>0){t.parents().eq(2).find("a:first").addClass("current");if(settings.navigation.nestedPagesFlows){var r=t.parent();r.parent().parent().find("ul").css({left:0}).stop(false,false).fadeTo("fast",1).delay(300).fadeTo("fast",0,function(){r.parent().parent().find("ul").removeAttr("style")});if(r.is("li:first-child")&&r.is("li:not(:last-child)")){_prevPage=t.parents().eq(2).find("a");_nextPage=r.next().find("a")}else if(t.parent().is("li:last-child")&&t.parent().is("li:not(:first-child)")){_prevPage=r.prev().find("a");_nextPage=t.parents().eq(2).next().find("a")}else if(r.is("li:first-child")&&r.is("li:last-child")){_prevPage=t.parents().eq(2).find("a");_nextPage=t.parents().eq(2).next().find("a")}else{_prevPage=r.prev().find("a");_nextPage=r.next().find("a")}}}else{var i=t.parent().find("ul").length;if(i>0&&settings.navigation.nestedPagesFlows){_nextPage=t.parent().children().find("a");_prevPage=t.parent().prev().find("a")}else{_nextPage=t.parent().next().find("a");_prevPage=t.parent().prev().find("a")}}if(_nextPage.attr("rel")==null){_nextPage=t.parents().eq(1).children(":first").find("a")}if(_prevPage.attr("rel")==null){_prevPage=t.parents().eq(1).children(":last").find("a")}e(".next").attr({rel:_nextPage.attr("rel"),href:_nextPage.attr("href"),title:_nextPage.attr("title")});if(_nextPage.attr("data-transition")!=null){e(".next").attr("data-transition",_nextPage.attr("data-transition"))}else{e(".next").removeAttr("data-transition")}e(".prev").attr({rel:_prevPage.attr("rel"),href:_prevPage.attr("href"),title:_prevPage.attr("title")});if(_prevPage.attr("data-transition")!=null){e(".prev").attr("data-transition",_prevPage.attr("data-transition"))}else{e(".prev").removeAttr("data-transition")}if(t.data("transition")!=null){if(t.data("transition").slideScroll!=null&&t.data("transition").slideScroll!==""){_thisSlideScroll=t.data("transition").slideScroll}if(t.data("transition").easing!=null&&t.data("transition").easing!==""){_thisSlideEasing=t.data("transition").easing}if(t.data("transition").callback!=null&&t.data("transition").callback!==""){_thisSlideCallback=t.data("transition").callback}}}function h(){if(!settings.animate&&settings.toLoad!==""&&settings.actual!==""){_tempSlideEasing="";_thisSlideEasing="";_tempSlideScroll="";_thisSlideScroll="";_thisSlideCallback="";_isAnimating=settings.toLoad;var s=settings.actual;if(settings.toLoad===""){window.location="#/"+r.first().find("a").attr("rel");settings.toLoad=r.first().find("a").attr("rel")}r.find("a").removeClass("current").each(function(){if(e(this).attr("rel")===settings.toLoad){e(this).toggleClass("current");c(e(this));return false}});if(s!==settings.toLoad){$oldpage=e("#"+s);$newpage=e("#"+settings.toLoad);settings.animate=true;csstop=-_scroll+settings.top;$oldpage.css({position:"fixed",top:csstop});i.css("min-height",t.height()+10-settings.top);e.data(document.body,"_scroll",_scroll);t.scrollTop(0);settings.actual=settings.toLoad;r.each(function(){if(e(this).find("a").attr("rel")===settings.toLoad){settings.url=e(this).find("a").attr("href");settings.title=e(this).find("a").attr("title");if(settings.title!==""){n.title=n.title.substring(0,n.title.lastIndexOf(" |"));n.title=n.title+" | "+settings.title}}});if($newpage.is("*")){if($newpage.hasClass("pageContainer")===false){$newpage.addClass("pageContainer")}$newpage.show();i.css("min-height",$newpage.css("height"))}else{i.append('<div class="pageContainer" id="'+settings.toLoad+'"/>');$newpage=e("#"+settings.toLoad);$newpage.css({"min-height":t.height()+10-settings.top});$newpage.hide();i.css("min-height",t.height()+10-settings.top);$newpage.append('<div class="loading"/>');_toLoad=true}if(_thisSlideScroll!==""){settings.slideScroll=_thisSlideScroll}if(_thisSlideEasing!==""){settings.easing=_thisSlideEasing}switch(settings.easing){case"fade":$newpage.css({left:0});if(_thisSlideCallback!==""&&!_toLoad){settings.callbacks[_thisSlideCallback]()}$newpage.hide();$oldpage.fadeOut(settings.speed,function(){$oldpage.css({position:"absolute",top:0})});$newpage.fadeIn(settings.speed,function(){if(_thisSlideEasing!==""){settings.easing=_tempSlideEasing;_tempSlideEasing="";_thisSlideEasing=""}if(_thisSlideScroll!==""){settings.slideScroll=_tempSlideScroll;_tempSlideScroll="";_thisSlideScroll=""}if(_toLoad){u()}_scroll=0;settings.animate=false;$oldpage.hide();if(_isAnimating!=settings.toLoad){h()}});break;default:if(settings.slideScroll==="vertical"){e.data($newpage,"z-index",$newpage.css("z-index"));$oldpage.after('<div class="outerold" />');$outerold=e(".outerold");$outerold.css({width:100+"%","min-height":t.height()+10,overflow:"hidden",position:"absolute",top:0,"z-index":parseInt($oldpage.css("z-index"))+1});$oldpage.css({position:"absolute",top:-e.data(document.body,"_scroll")});$outerold.wrapInner($oldpage);if(o(s)>o(settings.toLoad)){$newpage.css({left:0,top:t.height()-settings.top});moveActualPage=0-t.height()+settings.top}else{$newpage.css({left:0,top:0-t.height()+settings.top});moveActualPage=t.height()-settings.top}$newpage.show();if(_thisSlideCallback!==""&&!_toLoad){settings.callbacks[_thisSlideCallback]()}e("html, body").animate({scrollTop:0},10);$outerold.animate({top:moveActualPage},settings.speed,settings.easing,function(){$oldpage.unwrap();$oldpage.css({position:"absolute",top:0})});$newpage.animate({top:0},settings.speed,settings.easing,function(){if(_thisSlideEasing!==""){settings.easing=_tempSlideEasing;_tempSlideEasing="";_thisSlideEasing=""}if(_thisSlideScroll!==""){settings.slideScroll=_tempSlideScroll;_tempSlideScroll="";_thisSlideScroll=""}if(_toLoad){u()}_scroll=0;settings.animate=false;$oldpage.hide();if(_isAnimating!=settings.toLoad){h()}})}else{if(o(s)<o(settings.toLoad)){$newpage.css({left:t.width()});moveActualPage=0-t.width()}else{$newpage.css({left:0-t.width()});moveActualPage=t.width()}$newpage.show();if(_thisSlideCallback!==""&&!_toLoad){settings.callbacks[_thisSlideCallback]()}e("html, body").animate({scrollTop:0},10);$oldpage.animate({left:moveActualPage},settings.speed,settings.easing,function(){$oldpage.css({position:"absolute",top:0})});$newpage.animate({left:0},settings.speed,settings.easing,function(){if(_thisSlideEasing!==""){settings.easing=_tempSlideEasing;_tempSlideEasing="";_thisSlideEasing=""}if(_thisSlideScroll!==""){settings.slideScroll=_tempSlideScroll;_tempSlideScroll="";_thisSlideScroll=""}if(_toLoad){u()}_scroll=0;settings.animate=false;$oldpage.hide();if(_isAnimating!=settings.toLoad){h()}})}}}}}function p(){if(i.is("*")===false){e("body").wrapInner('<div id="contentSlide" />');i=e("#contentSlide")}i.css("top",settings.top);if(settings.navigation.show){l()}_tempSlideScroll=settings.slideScroll;_tempSlideEasing=settings.easing;if(r.is("*")){settings.actual=window.location.hash.replace("#/","");if(settings.actual===""){r.each(function(){if(e(this).hasClass("startPage")){settings.actual=e(this).find("a").attr("rel");window.location="#/"+settings.actual;_findStart=true}});if(!_findStart){window.location="#/"+r.first().find("a").attr("rel");settings.actual=r.first().find("a").attr("rel")}}r.each(function(){e("#"+e(this).find("a").attr("rel")).hide();if(e(this).find("a").attr("rel")===settings.actual){e(this).find("a").addClass("current");c(e(this).find("a"));settings.url=e(this).find("a").attr("href");settings.title=e(this).find("a").attr("title");if(settings.title!==""){n.title=n.title+" | "+settings.title}if(e(this).find("a").data("transition")!=null){if(e(this).find("a").data("transition").callback!=null&&e(this).find("a").data("transition").callback!==""){_thisSlideCallback=e(this).find("a").data("transition").callback}}}});$firstpage=e("#"+settings.actual);if($firstpage.is("*")){if($firstpage.hasClass("pageContainer")===false){$firstpage.addClass("pageContainer")}$firstpage.show();if(_thisSlideCallback!==""){settings.callbacks[_thisSlideCallback]()}i.css("min-height",e("#"+settings.actual).css("height"))}else{i.css("min-height",t.height()+10-settings.top);i.append('<div class="pageContainer" id="'+settings.actual+'"/>');$firstpage=e("#"+settings.actual);$firstpage.append('<div class="loading"/>');$firstpage.load(settings.url,function(){i.css("min-height",e("#"+settings.actual).css("height"));if(_thisSlideCallback!==""){settings.callbacks[_thisSlideCallback]()}})}}}var t,n,r,i;t=e(window);n=document;i=e("#contentSlide");_findStart=false;_scroll=0;_toLoad=false;_thisSlideScroll="";_thisSlideEasing="";_thisSlideCallback="";e("html, body").scrollTop(_scroll);var s=window.location!=window.parent.location?true:false;t.scroll(function(){_scroll=t.scrollTop()});t.resize(function(){if(settings.navigation){e(".next").css("top",Math.round((t.height()-e(".next").height())/2));e(".prev").css("top",Math.round((t.height()-e(".prev").height())/2))}if(parseInt(i.css("min-height"))<t.height()){i.css("min-height",t.height())}});e.fn.slidingPage=function(t){r=e(this);defaults={actual:"",toLoad:"",url:"",title:"",animate:false,speed:1500,easing:"easeInOutQuint",slideScroll:"horizontal",top:0,navigation:{show:true,nestedPagesFlows:true},callbacks:{}};settings=e.extend({},defaults,t);if(!s){e.address.init(p).change(a)}else{p()}r.find("a").add(".revolver").click(function(t){t.stopPropagation();f(e(this));return false})}})(jQuery);jQuery.easing["jswing"]=jQuery.easing["swing"];jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(e,t,n,r,i){return jQuery.easing[jQuery.easing.def](e,t,n,r,i)},easeInQuad:function(e,t,n,r,i){return r*(t/=i)*t+n},easeOutQuad:function(e,t,n,r,i){return-r*(t/=i)*(t-2)+n},easeInOutQuad:function(e,t,n,r,i){if((t/=i/2)<1)return r/2*t*t+n;return-r/2*(--t*(t-2)-1)+n},easeInCubic:function(e,t,n,r,i){return r*(t/=i)*t*t+n},easeOutCubic:function(e,t,n,r,i){return r*((t=t/i-1)*t*t+1)+n},easeInOutCubic:function(e,t,n,r,i){if((t/=i/2)<1)return r/2*t*t*t+n;return r/2*((t-=2)*t*t+2)+n},easeInQuart:function(e,t,n,r,i){return r*(t/=i)*t*t*t+n},easeOutQuart:function(e,t,n,r,i){return-r*((t=t/i-1)*t*t*t-1)+n},easeInOutQuart:function(e,t,n,r,i){if((t/=i/2)<1)return r/2*t*t*t*t+n;return-r/2*((t-=2)*t*t*t-2)+n},easeInQuint:function(e,t,n,r,i){return r*(t/=i)*t*t*t*t+n},easeOutQuint:function(e,t,n,r,i){return r*((t=t/i-1)*t*t*t*t+1)+n},easeInOutQuint:function(e,t,n,r,i){if((t/=i/2)<1)return r/2*t*t*t*t*t+n;return r/2*((t-=2)*t*t*t*t+2)+n},easeInSine:function(e,t,n,r,i){return-r*Math.cos(t/i*(Math.PI/2))+r+n},easeOutSine:function(e,t,n,r,i){return r*Math.sin(t/i*(Math.PI/2))+n},easeInOutSine:function(e,t,n,r,i){return-r/2*(Math.cos(Math.PI*t/i)-1)+n},easeInExpo:function(e,t,n,r,i){return t==0?n:r*Math.pow(2,10*(t/i-1))+n},easeOutExpo:function(e,t,n,r,i){return t==i?n+r:r*(-Math.pow(2,-10*t/i)+1)+n},easeInOutExpo:function(e,t,n,r,i){if(t==0)return n;if(t==i)return n+r;if((t/=i/2)<1)return r/2*Math.pow(2,10*(t-1))+n;return r/2*(-Math.pow(2,-10*--t)+2)+n},easeInCirc:function(e,t,n,r,i){return-r*(Math.sqrt(1-(t/=i)*t)-1)+n},easeOutCirc:function(e,t,n,r,i){return r*Math.sqrt(1-(t=t/i-1)*t)+n},easeInOutCirc:function(e,t,n,r,i){if((t/=i/2)<1)return-r/2*(Math.sqrt(1-t*t)-1)+n;return r/2*(Math.sqrt(1-(t-=2)*t)+1)+n},easeInElastic:function(e,t,n,r,i){var s=1.70158;var o=0;var u=r;if(t==0)return n;if((t/=i)==1)return n+r;if(!o)o=i*.3;if(u<Math.abs(r)){u=r;var s=o/4}else var s=o/(2*Math.PI)*Math.asin(r/u);return-(u*Math.pow(2,10*(t-=1))*Math.sin((t*i-s)*2*Math.PI/o))+n},easeOutElastic:function(e,t,n,r,i){var s=1.70158;var o=0;var u=r;if(t==0)return n;if((t/=i)==1)return n+r;if(!o)o=i*.3;if(u<Math.abs(r)){u=r;var s=o/4}else var s=o/(2*Math.PI)*Math.asin(r/u);return u*Math.pow(2,-10*t)*Math.sin((t*i-s)*2*Math.PI/o)+r+n},easeInOutElastic:function(e,t,n,r,i){var s=1.70158;var o=0;var u=r;if(t==0)return n;if((t/=i/2)==2)return n+r;if(!o)o=i*.3*1.5;if(u<Math.abs(r)){u=r;var s=o/4}else var s=o/(2*Math.PI)*Math.asin(r/u);if(t<1)return-.5*u*Math.pow(2,10*(t-=1))*Math.sin((t*i-s)*2*Math.PI/o)+n;return u*Math.pow(2,-10*(t-=1))*Math.sin((t*i-s)*2*Math.PI/o)*.5+r+n},easeInBack:function(e,t,n,r,i,s){if(s==undefined)s=1.70158;return r*(t/=i)*t*((s+1)*t-s)+n},easeOutBack:function(e,t,n,r,i,s){if(s==undefined)s=1.70158;return r*((t=t/i-1)*t*((s+1)*t+s)+1)+n},easeInOutBack:function(e,t,n,r,i,s){if(s==undefined)s=1.70158;if((t/=i/2)<1)return r/2*t*t*(((s*=1.525)+1)*t-s)+n;return r/2*((t-=2)*t*(((s*=1.525)+1)*t+s)+2)+n},easeInBounce:function(e,t,n,r,i){return r-jQuery.easing.easeOutBounce(e,i-t,0,r,i)+n},easeOutBounce:function(e,t,n,r,i){if((t/=i)<1/2.75){return r*7.5625*t*t+n}else if(t<2/2.75){return r*(7.5625*(t-=1.5/2.75)*t+.75)+n}else if(t<2.5/2.75){return r*(7.5625*(t-=2.25/2.75)*t+.9375)+n}else{return r*(7.5625*(t-=2.625/2.75)*t+.984375)+n}},easeInOutBounce:function(e,t,n,r,i){if(t<i/2)return jQuery.easing.easeInBounce(e,t*2,0,r,i)*.5+n;return jQuery.easing.easeOutBounce(e,t*2-i,0,r,i)*.5+r*.5+n}});(function(e){e.address=function(){var t=function(t){var n=e.extend(e.Event(t),function(){var t={},n=e.address.parameterNames();for(var r=0,i=n.length;r<i;r++){t[n[r]]=e.address.parameter(n[r])}return{value:e.address.value(),path:e.address.path(),pathNames:e.address.pathNames(),parameterNames:n,parameters:t,queryString:e.address.queryString()}}.call(e.address));e(e.address).trigger(n);return n},n=function(e){return Array.prototype.slice.call(e)},r=function(t,n,r){e().bind.apply(e(e.address),Array.prototype.slice.call(arguments));return e.address},i=function(t,n){e().unbind.apply(e(e.address),Array.prototype.slice.call(arguments));return e.address},s=function(){return z.pushState&&B.state!==N},o=function(){return("/"+W.pathname.replace(new RegExp(B.state),"")+W.search+(u()?"#"+u():"")).replace(J,"/")},u=function(){var e=W.href.indexOf("#");return e!=-1?h(W.href.substr(e+1),H):""},a=function(){return s()?o():u()},f=function(){try{return top.document!==N&&top.document.title!==N?top:window}catch(e){return window}},l=function(){return"javascript"},c=function(e){e=e.toString();return(B.strict&&e.substr(0,1)!="/"?"/":"")+e},h=function(e,t){if(B.crawlable&&t){return(e!==""?"!":"")+e}return e.replace(/^\!/,"")},p=function(e,t){return parseInt(e.css(t),10)},d=function(){if(!nt){var e=a(),t=decodeURI(ut)!=decodeURI(e);if(t){if(I&&F<7){W.reload()}else{if(I&&!Q&&B.history){V(y,50)}_old=ut;ut=e;v(H)}}}},v=function(e){var n=t(M),r=t(e?_:D);V(g,10);if(n.isDefaultPrevented()||r.isDefaultPrevented()){m()}},m=function(){ut=_old;if(s()){z.popState({},"",B.state.replace(/\/$/,"")+(ut===""?"/":ut))}else{nt=P;if(q){if(B.history){W.hash="#"+h(ut,P)}else{W.replace("#"+h(ut,P))}}else if(ut!=a()){if(B.history){W.hash="#"+h(ut,P)}else{W.replace("#"+h(ut,P))}}if(I&&!Q&&B.history){V(y,50)}if(q){V(function(){nt=H},1)}else{nt=H}}},g=function(){if(B.tracker!=="null"&&B.tracker!==C){var t=e.isFunction(B.tracker)?B.tracker:R[B.tracker],n=(W.pathname+W.search+(e.address&&!s()?e.address.value():"")).replace(/\/\//,"/").replace(/^\/$/,"");if(e.isFunction(t)){t(n)}else if(e.isFunction(R.urchinTracker)){R.urchinTracker(n)}else if(R.pageTracker!==N&&e.isFunction(R.pageTracker._trackPageview)){R.pageTracker._trackPageview(n)}else if(R._gaq!==N&&e.isFunction(R._gaq.push)){R._gaq.push(["_trackPageview",decodeURI(n)])}}},y=function(){var e=l()+":"+H+";document.open();document.writeln('<html><head><title>"+U.title.replace(/\'/g,"\\'")+"</title><script>var "+k+' = "'+encodeURIComponent(a()).replace(/\'/g,"\\'")+(U.domain!=W.hostname?'";document.domain="'+U.domain:"")+'";</'+"script></head></html>');document.close();";if(F<7){G.src=e}else{G.contentWindow.location.replace(e)}},b=function(){if(Z&&et!=-1){var e,t,n=Z.substr(et+1).split("&");for(e=0;e<n.length;e++){t=n[e].split("=");if(/^(autoUpdate|crawlable|history|strict|wrap)$/.test(t[0])){B[t[0]]=isNaN(t[1])?/^(true|yes)$/i.test(t[1]):parseInt(t[1],10)!==0}if(/^(state|tracker)$/.test(t[0])){B[t[0]]=t[1]}}Z=C}_old=ut;ut=a()},w=function(){if(!rt){rt=P;b();var n=function(){E.call(this);T.call(this)},r=e("body").ajaxComplete(n);n();if(B.wrap){var i=e("body > *").wrapAll('<div style="padding:'+(p(r,"marginTop")+p(r,"paddingTop"))+"px "+(p(r,"marginRight")+p(r,"paddingRight"))+"px "+(p(r,"marginBottom")+p(r,"paddingBottom"))+"px "+(p(r,"marginLeft")+p(r,"paddingLeft"))+'px;" />').parent().wrap('<div id="'+k+'" style="height:100%;overflow:auto;position:relative;'+(q&&!window.statusbar.visible?"resize:both;":"")+'" />');e("html, body").css({height:"100%",margin:0,padding:0,overflow:"hidden"});if(q){e('<style type="text/css" />').appendTo("head").text("#"+k+"::-webkit-resizer { background-color: #fff; }")}}if(I&&!Q){var o=U.getElementsByTagName("frameset")[0];G=U.createElement((o?"":"i")+"frame");G.src=l()+":"+H;if(o){o.insertAdjacentElement("beforeEnd",G);o[o.cols?"cols":"rows"]+=",0";G.noResize=P;G.frameBorder=G.frameSpacing=0}else{G.style.display="none";G.style.width=G.style.height=0;G.tabIndex=-1;U.body.insertAdjacentElement("afterBegin",G)}V(function(){e(G).bind("load",function(){var e=G.contentWindow;_old=ut;ut=e[k]!==N?e[k]:"";if(ut!=a()){v(H);W.hash=h(ut,P)}});if(G.contentWindow[k]===N){y()}},50)}V(function(){t("init");v(H)},1);if(!s()){if(Q){if(R.addEventListener){R.addEventListener(A,d,H)}else if(R.attachEvent){R.attachEvent("on"+A,d)}}else{X(d,50)}}if("state"in window.history){e(window).trigger("popstate")}}},E=function(){var t,n=e("a"),r=n.size(),i=1,s=-1,o='[rel*="address:"]',u=function(){if(++s!=r){t=e(n.get(s));if(t.is(o)){t.address(o)}V(u,i)}};V(u,i)},S=function(){if(decodeURI(ut)!=decodeURI(a())){_old=ut;ut=a();v(H)}},x=function(){if(R.removeEventListener){R.removeEventListener(A,d,H)}else if(R.detachEvent){R.detachEvent("on"+A,d)}},T=function(){if(B.crawlable){var t=W.pathname.replace(/\/$/,""),n="_escaped_fragment_";if(e("body").html().indexOf(n)!=-1){e('a[href]:not([href^=http]), a[href*="'+document.domain+'"]').each(function(){var r=e(this).attr("href").replace(/^http:/,"").replace(new RegExp(t+"/?$"),"");if(r===""||r.indexOf(n)!=-1){e(this).attr("href","#"+encodeURI(decodeURIComponent(r.replace(new RegExp("/(.*)\\?"+n+"=(.*)$"),"!$2"))))}})}}},N,C=null,k="jQueryAddress",L="string",A="hashchange",O="init",M="change",_="internalChange",D="externalChange",P=true,H=false,B={autoUpdate:P,crawlable:H,history:P,strict:P,wrap:H},j=e.browser,F=parseFloat(j.version),I=!e.support.opacity,q=j.webkit||j.safari,R=f(),U=R.document,z=R.history,W=R.location,X=setInterval,V=setTimeout,J=/\/{2,9}/g,K=navigator.userAgent,Q="on"+A in R,G,Y,Z=e("script:last").attr("src"),et=Z?Z.indexOf("?"):-1,tt=U.title,nt=H,rt=H,it=P,st=H,ot={},ut=a();_old=ut;if(I){F=parseFloat(K.substr(K.indexOf("MSIE")+4));if(U.documentMode&&U.documentMode!=F){F=U.documentMode!=8?7:8}var at=U.onpropertychange;U.onpropertychange=function(){if(at){at.call(U)}if(U.title!=tt&&U.title.indexOf("#"+a())!=-1){U.title=tt}}}if(z.navigationMode){z.navigationMode="compatible"}if(document.readyState=="complete"){var ft=setInterval(function(){if(e.address){w();clearInterval(ft)}},50)}else{b();e(w)}e(window).bind("popstate",S).bind("unload",x);return{bind:function(e,t,i){return r.apply(this,n(arguments))},unbind:function(e,t){return i.apply(this,n(arguments))},init:function(e,t){return r.apply(this,[O].concat(n(arguments)))},change:function(e,t){return r.apply(this,[M].concat(n(arguments)))},internalChange:function(e,t){return r.apply(this,[_].concat(n(arguments)))},externalChange:function(e,t){return r.apply(this,[D].concat(n(arguments)))},baseURL:function(){var e=W.href;if(e.indexOf("#")!=-1){e=e.substr(0,e.indexOf("#"))}if(/\/$/.test(e)){e=e.substr(0,e.length-1)}return e},autoUpdate:function(e){if(e!==N){B.autoUpdate=e;return this}return B.autoUpdate},crawlable:function(e){if(e!==N){B.crawlable=e;return this}return B.crawlable},history:function(e){if(e!==N){B.history=e;return this}return B.history},state:function(e){if(e!==N){B.state=e;var t=o();if(B.state!==N){if(z.pushState){if(t.substr(0,3)=="/#/"){W.replace(B.state.replace(/^\/$/,"")+t.substr(2))}}else if(t!="/"&&t.replace(/^\/#/,"")!=u()){V(function(){W.replace(B.state.replace(/^\/$/,"")+"/#"+t)},1)}}return this}return B.state},strict:function(e){if(e!==N){B.strict=e;return this}return B.strict},tracker:function(e){if(e!==N){B.tracker=e;return this}return B.tracker},wrap:function(e){if(e!==N){B.wrap=e;return this}return B.wrap},update:function(){st=P;this.value(ut);st=H;return this},title:function(e){if(e!==N){V(function(){tt=U.title=e;if(it&&G&&G.contentWindow&&G.contentWindow.document){G.contentWindow.document.title=e;it=H}},50);return this}return U.title},value:function(e){if(e!==N){e=c(e);if(e=="/"){e=""}if(ut==e&&!st){return}_old=ut;ut=e;if(B.autoUpdate||st){v(P);if(s()){z[B.history?"pushState":"replaceState"]({},"",B.state.replace(/\/$/,"")+(ut===""?"/":ut))}else{nt=P;if(q){if(B.history){W.hash="#"+h(ut,P)}else{W.replace("#"+h(ut,P))}}else if(ut!=a()){if(B.history){W.hash="#"+h(ut,P)}else{W.replace("#"+h(ut,P))}}if(I&&!Q&&B.history){V(y,50)}if(q){V(function(){nt=H},1)}else{nt=H}}}return this}return c(ut)},path:function(e){if(e!==N){var t=this.queryString(),n=this.hash();this.value(e+(t?"?"+t:"")+(n?"#"+n:""));return this}return c(ut).split("#")[0].split("?")[0]},pathNames:function(){var e=this.path(),t=e.replace(J,"/").split("/");if(e.substr(0,1)=="/"||e.length===0){t.splice(0,1)}if(e.substr(e.length-1,1)=="/"){t.splice(t.length-1,1)}return t},queryString:function(e){if(e!==N){var t=this.hash();this.value(this.path()+(e?"?"+e:"")+(t?"#"+t:""));return this}var n=ut.split("?");return n.slice(1,n.length).join("?").split("#")[0]},parameter:function(t,n,r){var i,s;if(n!==N){var o=this.parameterNames();s=[];n=n===N||n===C?"":n.toString();for(i=0;i<o.length;i++){var u=o[i],a=this.parameter(u);if(typeof a==L){a=[a]}if(u==t){a=n===C||n===""?[]:r?a.concat([n]):[n]}for(var f=0;f<a.length;f++){s.push(u+"="+a[f])}}if(e.inArray(t,o)==-1&&n!==C&&n!==""){s.push(t+"="+n)}this.queryString(s.join("&"));return this}n=this.queryString();if(n){var l=[];s=n.split("&");for(i=0;i<s.length;i++){var c=s[i].split("=");if(c[0]==t){l.push(c.slice(1).join("="))}}if(l.length!==0){return l.length!=1?l:l[0]}}},parameterNames:function(){var t=this.queryString(),n=[];if(t&&t.indexOf("=")!=-1){var r=t.split("&");for(var i=0;i<r.length;i++){var s=r[i].split("=")[0];if(e.inArray(s,n)==-1){n.push(s)}}}return n},hash:function(e){if(e!==N){this.value(ut.split("#")[0]+(e?"#"+e:""));return this}var t=ut.split("#");return t.slice(1,t.length).join("#")}}}();e.fn.address=function(t){var n;if(typeof t=="string"){n=t;t=undefined}if(!e(this).attr("address")){var r=function(n){if(n.shiftKey||n.ctrlKey||n.metaKey||n.which==2){return true}if(e(this).is("a")){n.preventDefault();var r=t?t.call(this):/address:/.test(e(this).attr("rel"))?e(this).attr("rel").split("address:")[1].split(" ")[0]:e.address.state()!==undefined&&!/^\/?$/.test(e.address.state())?e(this).attr("href").replace(new RegExp("^(.*"+e.address.state()+"|\\.)"),""):e(this).attr("href").replace(/^(#\!?|\.)/,"");e.address.value(r)}};e(n?n:this).live("click",r).live("submit",function(n){if(e(this).is("form")){n.preventDefault();var r=e(this).attr("action"),i=t?t.call(this):(r.indexOf("?")!=-1?r.replace(/&$/,""):r+"?")+e(this).serialize();e.address.value(i)}}).attr("address",true)}return this}})(jQuery)